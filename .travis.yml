sudo: true
dist: trusty
language: python
services:
- docker
before_install:
- git remote set-branches --add origin master
- git fetch
jobs:
  include:
  - stage: test backend
    script:
    - ./.travis/test_change_in_subproject.py backend --command="cd backend && docker-compose
      build && docker-compose run data_labeling_api make test"
  - stage: test frontend
    script:
    - ./.travis/test_change_in_subproject.py frontend --command="cd frontend && docker
      build ."
  - stage: deploy to staging
    if: branch = master
    script: "./.travis/deployment.sh staging"
env:
  global:
  - secure: gEDTzn3u5Ck6dYte7HT2NMgKinTeLeG6HPLCjreeYwC6MHwYK2VpNKIwPJ/U1UF0VBh6ugSya7iot1TYsVbcI2I+Jz92oGD37p+2eVrTfJAVr/5DRJ0XLKlhhYwvIcSUnau+QG3LjT3FYvXMqst4khbcubUJia6njJgRIF11KycymkJGTEFvmqt1ujFubNm0t8Zd0kK4TlXT9HUy4AkibfGF9qMpntjMZ0b9nxbBPc6n4ogpMxJvmC67lU9zBhP10ch1Tyq9SnqMWsaJb+eZ136yCnDkjmPhFGwRuz4A+56nrIYYXcgA7Y4LPrj8iF/x/Jrk3uMldvf/0Xa7ngXjcAK07seE5AErU9RAJgMlJf31khur/Lb5R4Jw6vB261YfPmXEfM+71eDAvmtT5rxMo/jQGz1ko+aoaDgLgZGffYNVKv9xcBWHHwt0XrE59TtRAZVOiGFitQCTwKgq6jk9rSfoW4SPPgpBVmntNppOPsyHu2CHxej5hg2FKJMnHfSIip97FJeox7S1seYcHSg/j12HNumfXri6GLewzCFGMUOec/4BisDcG1FPT3ccGcHIS8rK+5ndAkPnYM/GBYyMotnDJxvQMmoafcv28dR5bNM9MXaXI7TtRICcECXGvK3cPEcZFnTD968UMEQffQFTLjudS6NC1c7skSF68xAEQ8Y=
  - secure: m6wsBSxLavbMnkRdkGPujCC0JQLYOuYPqOvH65Bgy0JNVj0oWxydxNWEDo/5f0GC5Oq1XKOAE4+UBsohCtsDhTlJAzHEjudNn0sELGzla3hdRFPJUdnMZq4RDelr4Z60eAGNMqbF/v1BL5lQPP97zs5ZpVr39VvUqQwfurkBk6TeqggDZUpR4ZQ4ZdeQwo9dMp+hHT8QtSbtudSjqeUEYw4MDTatHa8LjczDauolRyhicWYLz8kF3ImOTB8QqcmnVsmFOmWC4moNepZC2g1GakZq9GEs48x1VniguGmCWrUbjnuo/Ka+rO6Vw8n+VL2bJVT7htGJnup1l8FQIkWnrfvL9P38+3ymuh4cOrSEKY+HkTGAMAM/LRAajGoklKYKr+WNX6mebqdGjMehoqdSiD1Fsh3UdGfeS1KF2yS/Ed/rXMnsKCA0Jp67fiWVL2MGnuGJGuy2vr4q3QUsBnx1v08WAPIfZAFIki4AMw+eqbS2nGvsNiVVFlziyRL2r4HQZ4WDWydyZM1OVj2eu/BanRRIl8jBPcbWK1QJM6fouf2lxKEEso8avOLm1VQQ5+w0RktLM/UcE6uSlbaDg6P8oBSR66IuDLjxF7ZFh+zchux/jJPkhY2xSI5+1bEUw/TuEwc9hs5HTfCf863qNT3qoOVpZZlKHvpDpcX/czBe6KE=
  - secure: QcNHTZCjpP+veg6wybJ4qM1WjXX6cvBELDqKRv0/cId5ppt7vqCPUa6AV0FOdnEKPk7ShiCNvwMMMSYvAXCGoyjopPcKZ+wWH7gHuSEWnqUvNiIiS6BTwMFttaW3Jzzds9Wiw/fgD0nHM87v42xFTGZ7bMzipQBrgaAUW4wcyvFpVplx1h92Jy9f9ALiDDH4ZmTa9+U1TOymRELZKzgIppiHIeBulX/DIlGcovDfTIoHKVsNYvaxMunsA5vhea2Ja6j9r4bOslJNye2FMo+NWnsE0wUX98aZH/MWbZzAlVoS1iJy39Mho2tSnmF+3l+LJ1S4I4JLzexZBiXCTQ3TNa3rFF6qNezCeFB4wey8Oqp7+uNjt3Bd15kToKzJrF0IrMGXR6k4/NjzvijRdYp6dg888FsX9m8+k1LFXF/APlNpgLWBRtC13u57Ed58NLVyca8keJHNN1pVvbIg9lnkf+i1NeohBjVhbd1Z1uTMvq93EG0DzsuKN7Ta6W6XZmPVH2tFF6KfZ8oicZjTcuIgUE+B+6cW6Vpwigy7ccOshslRiO5epKLN1yugDUZHFr1iVdzq8wJvFfC559Cw7le4UcsipoZBs33Y9j0upnkXGZL4rpuGfHU5DpyYQ9FqUzxpwfqKR9FrjJyVf7VkAM9xoQrCPvAAigBWPvs0HnIr67A=
